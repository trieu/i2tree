jQuery.extend({getUrlVars:function(){for(var a=[],b,c=window.location.href.slice(window.location.href.indexOf("?")+1).split("&"),d=0;d<c.length;d++)b=c[d].split("="),a.push(b[0]),a[b[0]]=decodeURIComponent(b[1]);return a},getUrlVar:function(a){return jQuery.getUrlVars()[a]}});var check_status=!1,statusUrl="http://nguyentantrieu.info/i2tree/index.php/cloud_storage/check_status";
function checkLogin(){jQuery.get(statusUrl,{},function(a){"false"===a?check_status=!1:(check_status=!0,autoPost&&addInfoNode())})}checkLogin();chrome.extension.onRequest.addListener(function(a){jQuery("#selected_html").html(a.html);jQuery("#name").html(safeStringForName(a.title));jQuery("#title").html(a.title);document.title+=a.title;jQuery("#keywords").html(a.keywords)});
function popupCenter(a,b,c,d,e,f){"undefined"===typeof e&&(e=screen.width/2-b/2);"undefined"===typeof d&&(d=screen.height/2-c/2);120<d&&(d-=70);a=window.open(a,"_blank","menubar=0,resizable=1,toolbar=no,location=no,directories=no,status=yes,menubar=no,scrollbars=no,resizable=yes,copyhistory=no,"+("width="+b+", height="+c+", top="+d+", left="+e));"function"===typeof a.focus&&!f&&a.focus();return a}var autoPost=!1;
function addInfoNode(){if(check_status){jQuery("#ajax_loader").show();var a={};a.html=jQuery("#selected_html").html();a.name=jQuery("#name").text();a.title=jQuery("#title").text();a.keywords=jQuery("#keywords").text();jQuery.post("http://nguyentantrieu.info/i2tree/index.php/cloud_storage/add_info_node",a,function(a){jQuery("#ajax_loader").hide();0<=a.indexOf("http")&&(jQuery("#published_url").attr("href",a).text(jQuery("#title").text()),window.location=a)})}else{var b=popupCenter(statusUrl+"?web_login=true",
960,600,50),c=setInterval(function(){b.closed&&(checkLogin(),clearInterval(c))},500);autoPost=!0;b.focus()}}
var vietnameseSigns=["aAeEoOuUiIdDyY".split(""),"\u00e1\u00e0??\u00e3\u00e2?????a?????".split(""),"\u00c1\u00c0??\u00c3\u00c2?????A?????".split(""),"\u00e9\u00e8???\u00ea?????".split(""),"\u00c9\u00c8???\u00ca?????".split(""),"\u00f3\u00f2??\u00f5\u00f4?????o?????".split(""),"\u00d3\u00d2??\u00d5\u00d4?????O?????".split(""),"\u00fa\u00f9??uu?????".split(""),"\u00da\u00d9??UU?????".split(""),["\u00ed","\u00ec","?","?","i"],["\u00cd","\u00cc","?","?","I"],["d"],["\u00d0"],["\u00fd","?","?","?","?"],
["\u00dd","?","?","?","?"]],removeSign=function(a){for(var b=1;b<vietnameseSigns.length;b++)for(var c=0;c<vietnameseSigns[b].length;c++)a=a.replace(vietnameseSigns[b][c],vietnameseSigns[0][b-1]);return a};String.prototype.allTrim=String.prototype.allTrim||function(){return this.split(/\-+/).join("-")};var safeStringForName=function(a){return removeSign(a).replace(/[^a-z0-9]/gi,"-").allTrim().toLowerCase()};jQuery(function(){jQuery("#btn_save2dropbox").button().click(addInfoNode)});